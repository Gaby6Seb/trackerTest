/* Basic Layout & Typography */
body {
font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
margin: 0;
color: #333;
display: flex;
flex-direction: column;
height: 100vh;
}

#map {
flex-grow: 1;
height: 100%;
z-index: 1;
}

/* Header Styles */
.header {
background: linear-gradient(45deg, #007bff, #00bfff);
color: white;
padding: 10px 20px;
text-align: center;
box-shadow: 0 2px 5px rgba(0,0,0,0.2);
z-index: 10;
}
.header h1 { margin: 0; font-size: 1.8em; }
.header .subtitle { margin: 5px 0 0; font-weight: 300; }

/* Controls Panel - Desktop Layout */
#controls-container {
position: absolute;
top: 100px;
right: 15px;
z-index: 1000;
background: rgba(255, 255, 255, 0.95);
padding: 15px;
border-radius: 8px;
box-shadow: 0 4px 12px rgba(0,0,0,0.2);
max-width: 320px;
width: 90vw;
max-height: calc(100vh - 120px);
display: flex;
flex-direction: column;
gap: 15px;
}

#player-search {
width: 100%;
padding: 10px;
border: 1px solid #ccc;
border-radius: 5px;
font-size: 1em;
box-sizing: border-box;
}

/* --- Generic styles for all collapsible containers --- */
#not-located-container,
#safezone-container,
#stealth-container {
overflow: hidden;
flex-shrink: 1;
min-height: 0;
display: flex;
flex-direction: column;
border-top: 1px solid #eee;
padding-top: 15px;
}
#controls-container > div:first-child {
border-top: none;
padding-top: 0;
}

#not-located-header,
#safezone-header,
#stealth-header {
cursor: pointer;
user-select: none;
margin: 0;
padding-bottom: 8px;
font-size: 1.1em;
display: flex;
justify-content: space-between;
align-items: center;
}

#toggle-icon,
#safezone-toggle-icon,
#stealth-toggle-icon {
font-weight: bold;
font-size: 1.4em;
line-height: 1;
color: #888;
}

#not-located-list,
#safezone-list,
#stealth-list {
list-style: none;
padding: 0;
margin: 0;
overflow-y: auto;
transition: max-height 0.3s ease-in-out, opacity 0.3s ease-in-out;
max-height: 200px;
opacity: 1;
}
#not-located-list li,
#safezone-list li,
#stealth-list li {
padding: 4px 8px; /* Added horizontal padding */
font-size: 0.9em;
border-radius: 4px; /* Added for hover effect */
}

#not-located-container.minimized #not-located-list,
#safezone-container.minimized #safezone-list,
#stealth-container.minimized #stealth-list {
max-height: 0;
opacity: 0;
}

/* --- NEW: Style for clickable list items --- */
.clickable-list-item {
    cursor: pointer;
    transition: background-color 0.2s ease-in-out;
}
.clickable-list-item:hover {
    background-color: #e9ecef;
}

/* --- NEW: Style for the highlighted list item --- */
li.highlighted {
background-color: #e7f3ff;
border-radius: 4px;
font-weight: bold;
transition: background-color 0.3s;
}

/* --- Marker style for Safe Zone players --- */
.safezone-marker .marker-pin-avatar::after,
.safezone-marker .marker-pin::after {
content: 'üõ°Ô∏è';
position: absolute;
top: -8px;
right: -8px;
font-size: 16px;
background: rgba(255, 255, 255, 0.8);
border-radius: 50%;
padding: 2px;
line-height: 1;
text-shadow: 0 0 2px #000;
}
.safezone-marker .marker-pin::after {
top: -20px;
right: -20px;
transform: rotate(45deg);
}

/* --- NEW: Faded marker for Last Known Locations --- */
.last-known-marker .marker-pin,
.last-known-marker .marker-pin-avatar {
    opacity: 0.6;
    filter: grayscale(80%);
}

/* Custom Marker and Popup Styles */
.marker-pin {
width: 30px; height: 30px; border-radius: 50% 50% 50% 0; background: #007bff;
position: absolute; transform: rotate(-45deg); left: 50%; top: 50%;
margin: -15px 0 0 -15px; border: 4px solid #fff;
}
.marker-pin-avatar {
width: 40px; height: 40px; border-radius: 50%; border: 4px solid #fff;
box-shadow: 0 0 0 2px #333; background-size: cover; background-position: center;
position: relative; transform: translateY(-8px);
}
.marker-avatar-image { width: 100%; height: 100%; border-radius: 50%; object-fit: cover; }
.marker-container { position: relative; }
.marker-pulse-effect {
border-radius: 50%; height: 40px; width: 40px; position: absolute;
top: -8px; left: 0; animation: pulsate 2s ease-out infinite;
opacity: 0; box-shadow: 0 0 1px 2px #fff;
}
.target-pulse { border: 3px solid rgba(255, 0, 0, 0.9); }
.teammate-pulse { border: 3px solid rgba(0, 255, 0, 0.9); }
@keyframes pulsate {
0% { transform: scale(0.9); opacity: 0.0; }
50% { opacity: 1.0; }
100% { transform: scale(1.4); opacity: 0.0; }
}
.leaflet-popup-content-wrapper { border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.2); }
.leaflet-popup-content { margin: 0 !important; width: auto !important; min-width: 250px !important; font-size: 14px; }
.popup-header {
padding: 10px 15px; font-weight: bold; color: white;
border-top-left-radius: 8px; border-top-right-radius: 8px;
display: flex; justify-content: space-between; align-items: center;
}
.popup-body { padding: 15px; line-height: 1.6; }
.popup-footer {
padding: 8px 15px; font-size: 12px; color: #888; background-color: #f7f7f7;
border-bottom-left-radius: 8px; border-bottom-right-radius: 8px; text-align: right;
}
.role-label {
font-size: 0.7em; padding: 2px 6px; border-radius: 10px;
color: white; font-weight: bold;
}
.role-label.target { background-color: #dc3545; }
.role-label.teammate { background-color: #28a745; }

.popup-actions {
padding: 0 15px 15px;
}
.popup-directions-btn {
width: 100%; padding: 10px; font-size: 1em; font-weight: bold;
color: white; background-color: #007bff; border: none;
border-radius: 5px; cursor: pointer; transition: background-color 0.2s ease-in-out;
}
.popup-directions-btn:hover { background-color: #0056b3; }

#filter-toggles {
display: flex; align-items: center; padding: 8px 4px;
background-color: #f0f0f0; border-radius: 5px;
}
#filter-toggles label {
display: flex; align-items: center; cursor: pointer; font-size: 0.9em;
color: #555; width: 100%; user-select: none;
}
#filter-toggles input[type="checkbox"] {
margin-right: 10px; transform: scale(1.2); accent-color: #007bff;
}

/* Mobile Layout Adjustments */
@media (max-width: 767px) {
#controls-container {
top: auto; bottom: 0; left: 0; right: 0;
width: 100%; max-width: none; border-radius: 15px 15px 0 0;
box-shadow: 0 -4px 12px rgba(0,0,0,0.15);
padding: 10px 15px 15px; max-height: 45vh; box-sizing: border-box;
}
#not-located-list, #safezone-list, #stealth-list { max-height: 25vh; }

/* Reorder items within the panel for better mobile UX */
#safezone-container { order: 1; }
#stealth-container { order: 2; }
#not-located-container { order: 3; }
#filter-toggles { order: 4; }
#search-container { order: 5; }
}
